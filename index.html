<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DEMOFM | MATRIX/BAUHAUS</title>
    
    <!-- PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://w.soundcloud.com/player/api.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- BAUHAUS/MATRIX STYLES --- */
        :root {
            --bg: #000000;
            --fg: #00ff00; /* Matrix Green */
            --border: 1px solid var(--fg);
            --font-main: 'Courier Prime', 'Courier New', monospace;
        }

        body {
            background-color: var(--bg);
            color: var(--fg);
            font-family: var(--font-main);
            min-height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0.5rem;
            box-sizing: border-box;
        }
        
        /* Main Application Frame (Maximized, no fluff) */
        .app-frame {
            background-color: var(--bg);
            width: 100%;
            max-width: 1400px;
            height: 98vh;
            max-height: 900px;
            border: var(--border);
            overflow: hidden;
        }

        /* --- UI Components --- */
        .module-box {
            border: var(--border);
            padding: 0.75rem;
            background-color: var(--bg);
        }
        
        .btn-matrix {
            background: var(--bg);
            color: var(--fg);
            padding: 8px 12px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            border: var(--border);
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1; /* Crisp text */
        }

        /* Inverted colors on hover/active for functional feedback */
        .btn-matrix:hover, .btn-matrix.active {
            background: var(--fg);
            color: var(--bg);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border: 1px solid var(--fg);
            background-color: transparent;
            margin-right: 6px;
            transition: background-color 0.2s;
        }

        .btn-matrix.active .status-dot {
            background: var(--bg); /* Inverted color */
        }

        .pulsate { animation: pulsate-anim 1s linear infinite; }
        @keyframes pulsate-anim { 50% { opacity: 0.5; } }

        /* Track/Info Display - Single line, minimal noise */
        .info-display {
            background: var(--bg);
            border: var(--border);
            color: var(--fg);
            padding: 0.5rem;
            font-size: 1.1rem;
            overflow: hidden;
            white-space: nowrap;
        }

        /* Volume Slider - Clean, functional styling */
        input[type=range] {
            -webkit-appearance: none;
            appearance: none;
            height: 2px;
            background: var(--fg);
            cursor: pointer;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 10px;
            height: 10px;
            background: var(--fg);
            border: 1px solid var(--bg);
        }

        /* --- Layout --- */
        .layout-grid {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        @media (min-width: 768px) {
            .layout-grid {
                flex-direction: row;
            }
            .sidebar {
                width: 300px;
                flex-shrink: 0;
                border-right: var(--border);
            }
        }
        .content-area {
            border-top: var(--border);
            padding: 0.75rem;
        }

        .scroll-hide::-webkit-scrollbar { display: none; }
        .scroll-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>

    <!-- MAIN APP FRAME -->
    <div class="app-frame layout-grid">

        <!-- LEFT COLUMN: CONTROLS & NAV -->
        <aside class="sidebar flex flex-col h-auto md:h-full p-2 gap-3">
            
            <!-- 1. HEADER LOGO -->
            <div class="module-box p-3 border-none flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-black tracking-tighter leading-none text-red-500">
                        <span style="color: var(--fg);">DEMO</span>FM
                    </h1>
                    <p class="text-xs mt-1">V6.0 // ONLINE</p>
                </div>
                <!-- Status indicator -->
                <div id="connection-dot" class="status-dot"></div>
            </div>

            <!-- 2. PLAYER MODULE -->
            <div class="module-box flex flex-col gap-3">
                <div class="flex justify-between items-center text-xs pb-2 border-b border-dashed border-current">
                    <span>AUDIO_MATRIX</span>
                    <span id="player-status" class="text-xs">IDLE</span>
                </div>
                
                <!-- Track Display -->
                <div class="info-display">
                    <span id="track-name" class="block whitespace-nowrap overflow-hidden text-ellipsis">COMMENCING BROADCAST...</span>
                </div>

                <!-- Controls -->
                <div class="grid grid-cols-3 gap-2 mt-1">
                    <button onclick="toggleAudio()" class="btn-matrix">
                        ⏯
                    </button>
                    <button onclick="skipTrack()" class="btn-matrix">
                        ⏭
                    </button>
                    <button onclick="randomSkip()" class="btn-matrix">
                        RND
                    </button>
                </div>

                <!-- Volume -->
                <div class="flex items-center gap-3 mt-2">
                    <span class="text-xs w-1/5">VOLUME</span>
                    <input type="range" min="0" max="100" value="70" class="flex-1" oninput="setVolume(this.value)">
                </div>
            </div>

            <!-- 3. NAVIGATION -->
            <nav class="module-box flex flex-col gap-2 flex-grow">
                <button onclick="navigate('live')" id="btn-live" class="btn-matrix active">
                    <span class="status-dot"></span> <span>LIVE FEED</span>
                </button>
                <button onclick="navigate('news')" id="btn-news" class="btn-matrix">
                    <span class="status-dot"></span> <span>DATA STREAM</span>
                </button>
                <button onclick="navigate('about')" id="btn-about" class="btn-matrix">
                    <span class="status-dot"></span> <span>PROTOCOL</span>
                </button>
            </nav>
            
             <!-- Listener Count (Functional Component) -->
            <div class="module-box text-center">
                <div id="listener-count" class="text-2xl font-bold">--</div>
                <div class="text-xs mt-1">LISTENERS CONNECTED</div>
            </div>

        </aside>

        <!-- RIGHT COLUMN: CONTENT SCREEN -->
        <main class="flex-1 relative overflow-hidden flex flex-col">
            
            <!-- Window Header -->
            <div class="bg-black text-white p-2 flex justify-between items-center text-sm font-bold border-b border-current" style="color: var(--fg);">
                <span id="screen-title">LIVE FREQUENCY</span>
                <!-- Time Display -->
                <span class="text-xs border border-current px-1" id="clock">00:00:00</span>
            </div>

            <!-- Scrollable Content Area -->
            <div class="overflow-y-auto h-full scroll-hide relative content-area" id="content-area">
                
                <!-- TAB: LIVE -->
                <div id="view-live" class="view-section">
                    <div class="module-box p-4 mb-4 border-dashed">
                        <h2 class="text-xl font-bold mb-2 uppercase">CURRENT BROADCAST</h2>
                        <p class="text-sm border-t border-dashed border-current pt-2">
                            STATUS: <span class="text-red-500">STREAMING @ 320 KBPS</span><br>
                            SOURCE: Fusion Festival 2019 Set Archive
                        </p>
                    </div>
                    
                    <h3 class="text-lg font-bold uppercase mt-6 mb-2">NETWORK LOG</h3>
                    <div class="module-box p-4 h-48 overflow-y-auto text-sm">
                        <ul id="network-log" class="space-y-1">
                            <!-- JS Log will go here -->
                        </ul>
                    </div>
                </div>

                <!-- TAB: NEWS -->
                <div id="view-news" class="view-section hidden">
                    <h2 class="text-xl font-bold uppercase mb-4 border-b border-current pb-1">DATA STREAM (ANNOUNCEMENTS)</h2>
                    <div id="news-feed" class="flex flex-col gap-2">
                        <!-- JS Will Inject Items Here -->
                    </div>
                </div>

                <!-- TAB: ABOUT (PROTOCOL) -->
                <div id="view-about" class="view-section hidden">
                    <h2 class="text-xl font-bold uppercase mb-4 border-b border-current pb-1">SYS.PROTOCOL V6.0</h2>
                    <p class="mb-4 text-sm leading-relaxed">
                        DEMOFM is a non-profit, non-commercial broadcast initiative. The interface is designed for maximum function and minimal aesthetic distraction. This system operates on a stripped-down Matrix/Bauhaus framework.
                    </p>
                    <div class="module-box p-3 text-sm">
                        <p><strong>OPERATOR:</strong> MG</p>
                        <p><strong>FRAMEWORK:</strong> HTML5/Tailwind-V6</p>
                        <p><strong>FONT:</strong> Courier Prime</p>
                    </div>
                </div>

            </div>

            <!-- Global Status Log Footer -->
            <div class="bg-black text-xs font-bold p-1 border-t border-current sticky bottom-0 flex-shrink-0">
                <span class="text-red-500 font-bold px-1">LOG:</span>
                <span id="sys-log">System Initializing...</span>
            </div>

        </main>
    </div>

    <!-- SOUNDCLOUD WIDGET (Hidden) -->
    <iframe id="sc-widget" 
            src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/ticket-countdown/sets/fusion-festival-2019-sets&color=%2300ff00&auto_play=false&hide_related=false&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true" 
            width="100%" 
            height="166" 
            scrolling="no" 
            frameborder="no" 
            allow="autoplay" 
            style="display: none;">
    </iframe>

    <script>
        // --- UTILITIES ---
        const networkLog = document.getElementById('network-log');
        let currentListeners = 1; // Start with 1 (the user)

        function log(msg) {
            // System Log Footer
            const sysLogEl = document.getElementById('sys-log');
            sysLogEl.innerText = `> ${msg}`;
            
            // Network Log (for persistent messages)
            const li = document.createElement('li');
            const timestamp = new Date().toTimeString().split(' ')[0];
            li.innerHTML = `[${timestamp}] ${msg}`;
            networkLog.prepend(li); // Newest message on top
            
            // Limit log to 10 entries
            while (networkLog.children.length > 10) {
                networkLog.removeChild(networkLog.lastChild);
            }
        }
        
        // --- NAVIGATION ---
        function navigate(viewId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.btn-matrix').forEach(el => el.classList.remove('active'));

            document.getElementById('view-' + viewId).classList.remove('hidden');
            document.getElementById('btn-' + viewId).classList.add('active');

            const titleMap = {
                live: 'LIVE FREQUENCY',
                news: 'DATA STREAM',
                about: 'SYS.PROTOCOL'
            };
            document.getElementById('screen-title').innerText = titleMap[viewId];
            log(`Navigation: Viewpoint set to ${viewId.toUpperCase()}`); 
        }

        // --- NEWS FEED GENERATOR (STARK DATA) ---
        const newsSources = [
            { src: 'NODE-A', title: 'ACCESS PROTOCOL UPDATED', date: 'TODAY' },
            { src: 'SYSTEM', title: 'DB RE-INDEX COMPLETE', date: 'YESTERDAY' },
            { src: 'ADMIN', title: 'BANDWIDTH OPTIMIZED', date: '2 DAYS AGO' }
        ];

        const feedContainer = document.getElementById('news-feed');
        feedContainer.innerHTML = ''; 
        
        newsSources.forEach(item => {
            const div = document.createElement('div');
            div.className = 'module-box p-3 cursor-pointer hover:bg-green-900 transition text-sm'; 
            div.innerHTML = `
                <div class="flex justify-between border-b border-dashed border-current pb-1 mb-1">
                    <span class="text-red-500">${item.src}</span>
                    <span>${item.date}</span>
                </div>
                <h3 class="font-bold leading-tight">${item.title}</h3>
            `;
            feedContainer.appendChild(div);
        });
        
        // --- LISTENER COUNT SIMULATION ---
        function updateListeners() {
            // Keep the initial listener count logic simple and functional
            document.getElementById('listener-count').innerText = currentListeners.toString().padStart(2, '0');
        }
        
        // --- AUDIO ENGINE ---
        var widgetIframe = document.getElementById('sc-widget');
        var widget = SC.Widget(widgetIframe);
        var isPlaying = false;
        const statusDot = document.getElementById('connection-dot');

        log("Initializing Audio Matrix...");
        updateListeners(); // Set initial count

        widget.setVolume(0.7);

        widget.bind(SC.Widget.Events.READY, function() {
            log("Audio Matrix Online. Awaiting command.");
            document.getElementById('track-name').innerText = "READY // ACTIVATE STREAM";
            document.getElementById('player-status').innerText = "IDLE";
            statusDot.classList.remove('pulsate');
        });

        widget.bind(SC.Widget.Events.PLAY, function() {
            isPlaying = true;
            document.getElementById('player-status').innerText = "STREAMING";
            statusDot.classList.add('pulsate');
            statusDot.style.backgroundColor = 'var(--fg)';
            
            widget.getCurrentSound(function(sound) {
                if(sound) {
                    let title = sound.title;
                    if(title.length > 30) title = title.substring(0, 30) + "...";
                    document.getElementById('track-name').innerText = title.toUpperCase();
                    log(`Now Playing: ${title}`);
                } else {
                    document.getElementById('track-name').innerText = "ERROR // TRACK INFO UNAVAILABLE";
                    log("WARNING: Track metadata unavailable.");
                }
            });
        });

        widget.bind(SC.Widget.Events.PAUSE, function() {
            isPlaying = false;
            document.getElementById('player-status').innerText = "PAUSED";
            statusDot.classList.remove('pulsate');
            statusDot.style.backgroundColor = 'transparent';
        });

        function toggleAudio() {
            if(!widget) return;
            widget.toggle();
        }

        function skipTrack() {
            if(!widget) return;
            log("Jumping to NEXT track.");
            widget.next();
        }
        
        function randomSkip() {
            if (!widget) return;
            // Skip 1 to 4 tracks forward
            const skipCount = Math.floor(Math.random() * 4) + 1; 
            log(`RANDOM SKIP: ${skipCount} tracks forward.`);
            
            let i = 0;
            // Sequential next() calls to simulate a random jump
            const interval = setInterval(() => {
                if (i < skipCount) {
                    widget.next();
                    i++;
                } else {
                    clearInterval(interval);
                    // Wait for the final track to load before logging
                    setTimeout(() => {
                        widget.getCurrentSound(function(sound) {
                            if (sound) {
                                log(`Randomized to: ${sound.title}`);
                            }
                        });
                    }, 500);
                }
            }, 100); 
        }

        function setVolume(val) {
            if(!widget) return;
            widget.setVolume(val / 100);
            log(`Volume: ${val}%`);
        }
        
        // --- CLOCK (Including seconds for more technical look) ---
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = 
                now.getHours().toString().padStart(2,'0') + ':' + 
                now.getMinutes().toString().padStart(2,'0') + ':' +
                now.getSeconds().toString().padStart(2,'0');
        }

        setInterval(updateClock, 1000);

        // Initialize on Live view
        navigate('live');
        updateClock();

    </script>
</body>
</html>
